#!/bin/bash

# Output file basename (extension is added after)
output_basename="$HOME/x11grab-$(date +%s)"

# The resolution of the screen area
# format:
# <width>x<height>
area="$(xdpyinfo | grep 'dimensions:' |awk '{print $2}')"
#area="1920x1080"

# Offset (upper-left corner)
# format:
# +<x_offset>,<y_offset>
offset=""

# Pulse source. List them with: $(pactl list sources)
# this is my pulse output. It could also be the mic input.
pulse_device="alsa_output.pci-0000_00_1b.0.analog-stereo.monitor"

audio_codec="libvorbis"
audio_bitrate="320k"

video_codec="h264 -preset ultrafast"

ffmpeg -f x11grab -r 30 -s $area -i :0.0$offset \
	-f pulse -i $pulse_device -ac 2 -acodec $audio_codec -b:a $audio_bitrate \
	-vcodec $video_codec \
	$output_basename.mp4
